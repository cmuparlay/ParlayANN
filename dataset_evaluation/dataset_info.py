import argparse
import os
import sys
import multiprocessing
import math 



bigann = "/ssd1/data/bigann"
msturing= "/ssd1/data/MSTuringANNS"
deep = "/ssd1/data/deep1b"
gist="/ssd1/data/gist"
ssnpp="/ssd1/data/FB_ssnpp"
wikipedia="/ssd1/data/wikipedia_cohere"
msmarco="/ssd1/data/msmarco_websearch"
text2image="/ssd1/data/text2image1B"
openai="/ssd1/data/OpenAIArXiv"
data_options = {
  "bigann-1M" : {"base": bigann+"/base.1B.u8bin.crop_nb_1000000", 
                "query": bigann+"/query.public.10K.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 10000,
                "esr": 30000,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 0,
                "gt": bigann+"/range_gt_1M_10000",
                "graph":bigann+"/graph_1M"},
  "bigann-10M" : {"base": bigann+"/base.1B.u8bin.crop_nb_10000000", 
                "query": bigann+"/query.public.10K.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 10000,
                "esr": 30000,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 0,
                "gt": bigann+"/range_gt_10M_10000",
                "graph":bigann+"/graph_10M"},
  "bigann-100M" : {"base": bigann+"/base.1B.u8bin.crop_nb_100000000", 
                "query": bigann+"/query.public.10K.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 10000,
                "esr": 30000,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 0,
                "gt": bigann+"/range_gt_100M_10000",
                "graph":bigann+"/graph_100M"},
  "bigann-1B" : {"base": bigann+"/base.1B.u8bin", 
                "query": bigann+"/query.public.10K.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 10000,
                "esr": 30000,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 0,
                "gt": bigann+"/range_gt_1B_10000",
                "graph":bigann+"/graph_1B"},
  "msturing-1M" : {"base": msturing+"/base1b.fbin.crop_nb_1000000", 
                "query": msturing+"/query100K.fbin", 
                "data_type" : "float", 
                "dist_fn": "Euclidian",
                "radius": .3,
                "esr": 1.6,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 1,
                "gt": msturing+"/range_gt_1M_100K_.3",
                "graph":msturing+"graph_1M"},
  "deep-1M" : {"base": deep+"/base.1B.fbin.crop_nb_1000000", 
                "query": deep+"/query.public.10K.fbin", 
                "data_type" : "float",
                "dist_fn": "Euclidian",
                "radius": .02,
                "esr": .4,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 1,
                "gt": deep+"/range_gt_1M_.02",
                "graph":deep+"/graph_1M"},
  "gist-1M" : {"base": gist+"/gist_base.fbin", 
                "query": gist+"/gist_query_10K.fbin", 
                "data_type" : "float", 
                "dist_fn": "Euclidian",
                "radius": .5,
                "esr": 2.5,
                "R":64,
                "L":128,
                "alpha": 1.15,
                "quantize_mode": 1,
                "gt": gist+"/range_gt_1M_10K_.5",
                "graph":gist+"/graph_1M"},
  "ssnpp-1M" : {"base": ssnpp+"/FB_ssnpp_database.u8bin.crop_nb_1000000", 
                "query": ssnpp+"/FB_ssnpp_public_queries.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 96237,
                "esr": 200000,
                "R":80,
                "L":200,
                "alpha": 1.10,
                "quantize_mode": 0,
                "gt": ssnpp+"/ssnpp-1M",
                "graph":ssnpp+"/graph_1M"},
  "ssnpp-10M" : {"base": ssnpp+"/FB_ssnpp_database.u8bin.crop_nb_10000000", 
                "query": ssnpp+"/FB_ssnpp_public_queries.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 96237,
                "esr": 200000,
                "R":80,
                "L":200,
                "quantize_mode": 0,
                "alpha": 1.10,
                "gt": ssnpp+"/ssnpp-10M",
                "graph":ssnpp+"/graph_10M"},
  "ssnpp-100M" : {"base": ssnpp+"/FB_ssnpp_database.u8bin.crop_nb_100000000", 
                "query": ssnpp+"/FB_ssnpp_public_queries.u8bin", 
                "data_type" : "uint8", 
                "dist_fn": "Euclidian",
                "radius": 96237,
                "esr": 200000,
                "R":80,
                "L":200,
                "quantize_mode": 0,
                "alpha": 1.10,
                "gt": ssnpp+"/ssnpp-100M",
                "graph":ssnpp+"/graph_100M"},
  "wikipedia-1M" : {"base":wikipedia+"/wikipedia_base.bin.crop_nb_1000000", 
                "query": wikipedia+"/wikipedia_query.bin", 
                "data_type" : "float", 
                "dist_fn": "mips",
                "radius": -10.5,
                "esr": -9.5, #final choice 
                "R":64,
                "L":128,
                "quantize_mode": 1,
                "alpha": 1.0, 
                "gt": wikipedia+"/range_gt_1M_-10.5",
                "graph":wikipedia+"/graph_1M"},
  "wikipedia-10M" : {"base":wikipedia+"/wikipedia_base.bin.crop_nb_10000000", 
                "query": wikipedia+"/wikipedia_query.bin", 
                "data_type" : "float", 
                "dist_fn": "mips",
                "radius": -10.5,
                "esr": -9.5, #final choice 
                "R":64,
                "L":128,
                "quantize_mode": 1,
                "alpha": 1.0, 
                "gt": wikipedia+"/range_gt_10M_-10.5",
                "graph":wikipedia+"/graph_10M"},
  "msmarcowebsearch-1M" : {"base": msmarco+"/vectors.bin.crop_nb_1000000", 
                "query": msmarco+"/query.bin", 
                "data_type" : "float", 
                "dist_fn": "mips",
                "radius": -62,
                "esr": -57, #final choice
                "R":64,
                "L":128,
                "quantize_mode": 1,
                "alpha": 1.0,
                "gt": msmarco+"/range_gt_1M_-62",
                "graph":msmarco+"/graph_1M"},
  "text2image-1M" : {"base": text2image+"/base.1B.fbin.crop_nb_1000000", 
                "query": text2image+"/query.public.100K.fbin", 
                "data_type" : "float", 
                "dist_fn": "mips",
                "radius": -.60,
                "esr": 0, 
                "R":64,
                "L":128,
                "quantize_mode": 1,
                "alpha": 1.0,
                "gt": text2image+"/range_gt_1M_-.6",
                "graph":text2image+"/graph_1M"},
  "openai-1M" : {"base": openai+"/openai_base.bin.crop_nb_1000000", 
                "query": openai+"/openai_query_10K.bin", 
                "data_type" : "float", 
                "dist_fn": "Euclidian",
                "radius": .2,
                "esr": .28, #final choice 
                "R":64,
                "L":128,
                "quantize_mode": 1,
                "alpha": 1.15,
                "gt": openai+"/openai_gt_1M_.2",
                "graph":openai+"/graph_1M"},
}

mk = ['o', 'v', '^', '1', 's', '+', 'x', 'D', '|', '>', '<',]

dsinfo = {
  "bigann-1M" : {"marker": mk[0], 
                "color": "C0"},
  "bigann-10M" : {"marker": mk[0], 
                "color": "C0"},
  "bigann-100M" : {"marker": mk[0], 
                "color": "C0"},
  "msturing-1M" : {"marker": mk[1], 
                "color": "C1"},
  "deep-1M" : {"marker": mk[2], 
                "color": "C2"},
  "gist-1M" : {"marker": mk[3], 
                "color": "C3"},
  "ssnpp-1M" : {"marker": mk[4], 
                "color": "C4"},
  "ssnpp-10M" : {"marker": mk[4], 
                "color": "C4"},
  "ssnpp-100M" : {"marker": mk[4], 
                "color": "C4"},
  "wikipedia-1M" : {"marker": mk[5], 
                "color": "C5"},
  "wikipedia-10M" : {"marker": mk[5], 
                "color": "C5"},
  "msmarcowebsearch-1M" : {"marker": mk[6], 
                "color": "C6"},
  "text2image-1M" : {"marker": mk[7], 
                "color": "C7"},
  "openai-1M" : {"marker": mk[8], 
                "color": "C8"},
}


